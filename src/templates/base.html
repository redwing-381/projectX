<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}ProjectX{% endblock %}</title>
    <!-- Preconnect for faster font loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Load fonts with display=swap to prevent blocking -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Minified critical CSS -->
    <style>
        :root{--bg-primary:#0f0f0f;--bg-secondary:#171717;--bg-tertiary:#212121;--bg-hover:#2a2a2a;--sidebar-bg:#0f0f0f;--sidebar-width:260px;--sidebar-border:#2a2a2a;--text-primary:#fafafa;--text-secondary:#a3a3a3;--text-muted:#737373;--accent-primary:#fafafa;--accent-primary-hover:#e5e5e5;--accent-success:#22c55e;--accent-warning:#f59e0b;--accent-danger:#ef4444;--spacing-xs:4px;--spacing-sm:8px;--spacing-md:16px;--spacing-lg:24px;--spacing-xl:32px;--radius-sm:6px;--radius-md:8px;--radius-lg:12px;--transition-fast:150ms ease;--transition-normal:200ms ease}
        *{font-family:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;box-sizing:border-box}
        body{background:var(--bg-primary);color:var(--text-primary);margin:0}
        .app-container{display:flex;min-height:100vh}
        .sidebar{width:var(--sidebar-width);background:var(--sidebar-bg);border-right:1px solid var(--sidebar-border);position:fixed;top:0;left:0;height:100vh;display:flex;flex-direction:column;z-index:40;transition:transform var(--transition-normal)}
        .sidebar-header{padding:var(--spacing-lg);border-bottom:1px solid var(--sidebar-border)}
        .sidebar-logo{display:flex;align-items:center;gap:var(--spacing-md)}
        .sidebar-logo-icon{width:36px;height:36px;background:#fafafa;border-radius:var(--radius-md);display:flex;align-items:center;justify-content:center}
        .sidebar-logo-text{font-size:20px;font-weight:700}
        .sidebar-nav{flex:1;overflow-y:auto;padding:var(--spacing-md) 0}
        .nav-section{margin-bottom:var(--spacing-lg)}
        .nav-section-title{padding:var(--spacing-sm) var(--spacing-lg);font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.05em;color:var(--text-muted)}
        .nav-item{display:flex;align-items:center;gap:var(--spacing-md);padding:10px var(--spacing-lg);margin:2px var(--spacing-sm);border-radius:var(--radius-md);color:var(--text-secondary);text-decoration:none;transition:all var(--transition-fast);position:relative}
        .nav-item:hover{background:var(--bg-hover);color:var(--text-primary)}
        .nav-item.active{background:rgba(250,250,250,.08);color:var(--accent-primary)}
        .nav-item.active::before{content:'';position:absolute;left:0;top:50%;transform:translateY(-50%);width:3px;height:24px;background:var(--accent-primary);border-radius:0 2px 2px 0}
        .nav-icon{width:20px;height:20px;flex-shrink:0}
        .nav-label{font-size:14px;font-weight:500}
        .sidebar-footer{padding:var(--spacing-md) var(--spacing-lg);border-top:1px solid var(--sidebar-border)}
        .status-indicator{display:flex;align-items:center;gap:var(--spacing-sm);padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border-radius:var(--radius-md);font-size:13px}
        .status-dot{width:8px;height:8px;border-radius:50%;background:var(--text-muted)}
        .status-dot.active{background:var(--accent-success);animation:pulse 2s infinite}
        @keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
        .sidebar-version{margin-top:var(--spacing-sm);font-size:12px;color:var(--text-muted);text-align:center}
        .main-content{flex:1;margin-left:var(--sidebar-width);min-height:100vh;display:flex;flex-direction:column}
        .page-header{padding:var(--spacing-lg) var(--spacing-xl);border-bottom:1px solid var(--sidebar-border);background:var(--bg-secondary)}
        .page-content{flex:1;padding:var(--spacing-xl);max-width:1400px}
        .mobile-header{display:none;position:fixed;top:0;left:0;right:0;height:60px;background:var(--sidebar-bg);border-bottom:1px solid var(--sidebar-border);padding:0 var(--spacing-md);align-items:center;justify-content:space-between;z-index:30}
        .hamburger-btn{width:44px;height:44px;display:flex;align-items:center;justify-content:center;background:transparent;border:none;color:var(--text-primary);cursor:pointer;border-radius:var(--radius-md)}
        .hamburger-btn:hover{background:var(--bg-hover)}
        .sidebar-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:35;opacity:0;transition:opacity var(--transition-normal)}
        .sidebar-overlay.active{opacity:1}
        .card{background:var(--bg-secondary);border:1px solid var(--sidebar-border);border-radius:var(--radius-lg);overflow:hidden}
        .card-header{padding:var(--spacing-lg);border-bottom:1px solid var(--sidebar-border);display:flex;align-items:center;justify-content:space-between}
        .card-title{font-size:16px;font-weight:600}
        .card-body{padding:var(--spacing-lg)}
        .stat-card{background:var(--bg-secondary);border:1px solid var(--sidebar-border);border-radius:var(--radius-lg);padding:var(--spacing-lg);display:flex;align-items:flex-start;gap:var(--spacing-md)}
        .stat-icon{width:44px;height:44px;border-radius:var(--radius-md);display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0}
        .stat-content{flex:1}
        .stat-value{font-size:28px;font-weight:700;line-height:1.2}
        .stat-label{font-size:13px;color:var(--text-secondary);margin-top:2px}
        .btn{display:inline-flex;align-items:center;justify-content:center;gap:var(--spacing-sm);padding:10px 20px;font-size:14px;font-weight:500;border-radius:var(--radius-md);border:none;cursor:pointer;transition:all var(--transition-fast)}
        .btn-primary{background:var(--accent-primary);color:#0f0f0f}
        .btn-primary:hover{background:var(--accent-primary-hover);transform:translateY(-1px)}
        .btn-secondary{background:var(--bg-tertiary);color:var(--text-primary);border:1px solid var(--sidebar-border)}
        .btn-secondary:hover{background:var(--bg-hover)}
        .btn-success{background:var(--accent-success);color:#fff}
        .btn-danger{background:var(--accent-danger);color:#fff}
        .demo-banner{background:#fafafa;color:#0f0f0f;padding:10px 20px;display:flex;align-items:center;justify-content:space-between;font-size:14px;font-weight:500}
        .demo-banner-text{display:flex;align-items:center;gap:8px}
        .demo-banner-text svg{stroke:#0f0f0f}
        .demo-banner .btn{background:rgba(0,0,0,.2);color:#0f0f0f;padding:6px 14px;font-size:13px}
        .demo-banner .btn:hover{background:rgba(0,0,0,.3)}
        @media(max-width:768px){.sidebar{transform:translateX(-100%)}.sidebar.open{transform:translateX(0)}.mobile-header{display:flex}.sidebar-overlay.show{display:block}.main-content{margin-left:0;padding-top:60px}.page-content{padding:var(--spacing-md)}}
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Mobile Header -->
        <header class="mobile-header">
            <button class="hamburger-btn" onclick="toggleSidebar()" aria-label="Toggle menu">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h18M3 6h18M3 18h18"/></svg>
            </button>
            <div class="sidebar-logo">
                <span class="sidebar-logo-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#0f0f0f" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></span>
                <span class="sidebar-logo-text">ProjectX</span>
            </div>
            <div style="width:44px"></div>
        </header>
        
        <!-- Sidebar Overlay -->
        <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>
        
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <span class="sidebar-logo-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#0f0f0f" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></span>
                    <span class="sidebar-logo-text">ProjectX</span>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Main</div>
                    <a href="/" class="nav-item {% if active_page == 'dashboard' %}active{% endif %}">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
                        <span class="nav-label">Dashboard</span>
                    </a>
                    <a href="/notifications" class="nav-item {% if active_page == 'notifications' %}active{% endif %}">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
                        <span class="nav-label">Notifications</span>
                    </a>
                    <a href="/history" class="nav-item {% if active_page == 'history' %}active{% endif %}">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                        <span class="nav-label">History</span>
                    </a>
                    <a href="/analytics" class="nav-item {% if active_page == 'analytics' %}active{% endif %}">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></svg>
                        <span class="nav-label">Analytics</span>
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Configuration</div>
                    <a href="/vip-senders" class="nav-item {% if active_page == 'vip' %}active{% endif %}">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                        <span class="nav-label">VIP Senders</span>
                    </a>
                    <a href="/keywords" class="nav-item {% if active_page == 'keywords' %}active{% endif %}">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="4" y1="9" x2="20" y2="9"/><line x1="4" y1="15" x2="20" y2="15"/><line x1="10" y1="3" x2="8" y2="21"/><line x1="16" y1="3" x2="14" y2="21"/></svg>
                        <span class="nav-label">Keywords</span>
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">System</div>
                    <a href="/architecture" class="nav-item {% if active_page == 'architecture' %}active{% endif %}">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
                        <span class="nav-label">Architecture</span>
                    </a>
                    <a href="/settings" class="nav-item {% if active_page == 'settings' %}active{% endif %}">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
                        <span class="nav-label">Settings</span>
                    </a>
                </div>
            </nav>
            
            <div class="sidebar-footer">
                <div class="status-indicator">
                    <span class="status-dot {% if monitoring_active %}active{% endif %}"></span>
                    <span>{% if monitoring_active %}Monitoring Active{% else %}Monitoring Inactive{% endif %}</span>
                </div>
                <div class="sidebar-version">ProjectX v0.1.0</div>
            </div>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            {% if demo_mode %}
            <div class="demo-banner">
                <div class="demo-banner-text">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>
                    Demo Mode Active - Using sample emails (no real data)
                </div>
                <form action="/demo/deactivate" method="POST" style="margin:0">
                    <button type="submit" class="btn">Exit Demo</button>
                </form>
            </div>
            {% endif %}
            {% block content %}{% endblock %}
        </main>
    </div>
    
    <script>function toggleSidebar(){const s=document.getElementById('sidebar'),o=document.getElementById('sidebarOverlay');s.classList.toggle('open');o.classList.toggle('show');o.classList.toggle('active')}function closeSidebar(){const s=document.getElementById('sidebar'),o=document.getElementById('sidebarOverlay');s.classList.remove('open');o.classList.remove('show');o.classList.remove('active')}document.addEventListener('keydown',e=>{if(e.key==='Escape')closeSidebar()});</script>
</body>
</html>